<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Life - Home</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <!-- Updated favicon  to use App.png -->
    <link rel="icon" type="image/png" href="./App.png">   

    <!-- Enhanced PWA meta tags -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#A94EBD">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Life">
    <link rel="apple-touch-icon" href="/App.png">
    <meta name="msapplication-TileColor" content="#A94EBD">
    <meta name="msapplication-TileImage" content="/App.png">
    <meta name="description" content="Learn about Life - Your beautiful reminder and task management app">
    
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&family=Kalam:wght@400;700&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(135deg, #F3E9E9 0%, #E8D5E8 100%);
            min-height: 100vh;
        }

        .font-handwriting {
            font-family: 'Kalam', cursive;
        }

        /* Glassmorphism Effect */
        .glass {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }

        /* Loading Animation */
        .loading-spinner {
            border: 2px solid #f3f3f3;
            border-top: 2px solid #A94EBD;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        /* Floating Animation */
        @keyframes float {

            0%,
            100% {
                transform: translateY(0px) rotate(1deg);
            }

            50% {
                transform: translateY(-5px) rotate(-1deg);
            }
        }

        .animate-float {
            animation: float 4s ease-in-out infinite;
        }

        /* Custom Input Styles */
        .custom-input {
            border: 1px solid rgba(75, 46, 94, 0.2);
            transition: all 0.3s ease;
        }

        .custom-input:focus {
            border-color: #A94EBD;
            box-shadow: 0 0 0 2px rgba(169, 78, 189, 0.2);
        }

        /* Button Styles */
        .btn-primary {
            background: linear-gradient(135deg, #A94EBD 0%, #4B2E5E 100%);
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(75, 46, 94, 0.15);
        }

        /* Mobile Menu */
        .mobile-menu {
            transition: all 0.3s ease;
            max-height: 0;
            overflow: hidden;
        }

        .mobile-menu.open {
            max-height: 500px;
        }

        /* User dropdown */
        .user-dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            right: 0;
            background-color: white;
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
            z-index: 1;
            border-radius: 8px;
            overflow: hidden;
        }

        .dropdown-content a {
            color: #4B2E5E;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            font-size: 14px;
            transition: all 0.3s;
        }

        .dropdown-content a:hover {
            background-color: #f3e9ff;
        }

        .show {
            display: block;
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: #f0e4ff;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #A94EBD;
            font-weight: bold;
            cursor: pointer;
        }

        /* Enhanced scroll styling for reviews section */
        .reviews-scroll {
            max-height: 400px;
            overflow-y: auto;
            /* Hide scrollbar completely */
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* Internet Explorer 10+ */
            padding-right: 8px;
            scroll-behavior: smooth;
        }

        /* Hide webkit scrollbar */
        .reviews-scroll::-webkit-scrollbar {
            display: none;
        }

        /* Modal Styling */
        #thankYouModal .glass {
            transform: scale(0.9);
            opacity: 0;
            transition: all 0.3s ease;
        }
    </style>
</head>

<body>
    <!-- Firebase Configuration -->
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBi4feeVAPUJJXe9qUV7j-SutsGFRnZBjo",
            authDomain: "lifeappcy.firebaseapp.com",
            projectId: "lifeappcy",
            storageBucket: "lifeappcy.firebasestorage.app",
            messagingSenderId: "598700486958",
            appId: "1:598700486958:web:307187bca0966041e84abf",
            measurementId: "G-57C80GJLZD"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
    </script>

    <!-- Header -->
    <header class="glass mx-4 mt-4 rounded-2xl px-6 py-4 shadow-lg sticky top-0 z-50">
        <div class="flex items-center justify-between max-w-7xl mx-auto">
            <div class="flex items-center space-x-3">
                <div class="from-[#A94EBD] to-[#4B2E5E] rounded-xl flex items-center justify-center">
                    <img src="imeges/Life Logo.png" alt="Life Logo" class="w-13 h-12 object-contain">
                </div>
                <div>
                    <span class="font-bold text-[#4B2E5E] text-2xl">Life</span>
                    <p class="text-xs text-[#4B2E5E] opacity-70">Organize your life beautifully</p>
                </div>
            </div>

            <nav class="hidden md:flex space-x-6 text-xs text-[#7a5a5a] font-semibold tracking-wide">
                <a class="hover:text-[#a87f7f] transition-colors" href="index.html">HOME</a>
                <a class="hover:text-[#a87f7f] transition-colors" href="about.html">ABOUT</a>
                <a class="hover:text-[#a87f7f] transition-colors" href="features.html">FEATURES</a>
                <a class="hover:text-[#a87f7f] transition-colors" href="#help">HELP</a>
                <a class="hover:text-[#a87f7f] transition-colors" href="review.html">REVIEWS</a>
            </nav>

            <div class="flex items-center space-x-3">
                <button id="mobileMenuButton" class="md:hidden text-[#4B2E5E]">
                    <i class="fas fa-bars text-xl"></i>
                </button>
                <div id="authSection">
                    <a href="login.html"
                        class="text-sm font-semibold text-[#4B2E5E] hover:text-[#A94EBD] transition-colors">LOGIN</a>
                </div>
            </div>
        </div>

        <!-- Mobile Menu -->
        <div id="mobileMenu" class="mobile-menu md:hidden mt-4">
            <div class="flex flex-col space-y-3 text-xs text-[#7a5a5a] font-semibold tracking-wide">
                <a class="hover:text-[#a87f7f] transition-colors py-2" href="index.html">HOME</a>
                <a class="hover:text-[#a87f7f] transition-colors py-2" href="about.html">ABOUT</a>
                <a class="hover:text-[#a87f7f] transition-colors py-2" href="features.html">FEATURES</a>
                <a class="hover:text-[#a87f7f] transition-colors py-2" href="Todo.html">TODO LIST</a>
                <a class="hover:text-[#a87f7f] transition-colors py-2" href="#help">HELP</a>
                <a class="hover:text-[#a87f7f] transition-colors py-2" href="review.html">REVIEWS</a>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section
        class="max-w-6xl mx-auto px-4 py-12 md:py-20 flex flex-col md:flex-row items-center justify-between gap-10">
        <div class="flex-1 max-w-xl">
            <h1 class="text-4xl md:text-5xl font-bold text-[#4B2E5E] mb-4">Your Smart Assistant for Daily Reminders!
            </h1>
            <p class="text-lg text-[#4B2E5E] opacity-80 mb-8">Stay organized, productive, and stress-free with Lifeâ€”your
                all-in-one app with calendars, sticky notes, to-do lists, and more!</p>
            <a href="features.html" class="btn-primary text-white font-semibold px-8 py-3 rounded-xl inline-block">
                <i class="fas fa-rocket mr-2"></i>Explore Features
            </a>
        </div>
        <div class="flex-1 max-w-md animate-float">
            <img src="imeges/Hom Page/Hero Image.png" alt="Life App Illustration" class="w-full h-auto">
        </div>
    </section>

    <!-- Features Section -->
    <section class="max-w-6xl mx-auto px-4 py-12">
        <div class="text-center mb-12">
            <h2 class="text-3xl font-bold text-[#4B2E5E] mb-2">What Life Offers?</h2>
            <p class="text-[#4B2E5E] opacity-80 max-w-2xl mx-auto">Discover the powerful features that will transform
                how you organize your life</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            <div class="glass rounded-2xl p-6 text-center hover:transform hover:-translate-y-2 transition-transform">
                <div
                    class="w-16 h-16 mx-auto bg-gradient-to-br from-[#A94EBD] to-[#4B2E5E] rounded-2xl flex items-center justify-center mb-4">
                    <i class="fas fa-sticky-note text-white text-2xl"></i>
                </div>
                <h3 class="text-xl font-semibold text-[#4B2E5E] mb-2">Sticky Notes</h3>
                <p class="text-sm text-[#4B2E5E] opacity-80 mb-4">Jot down ideas, reminders, or tasksâ€”always accessible
                    and never lost!</p>
                <a href="features.html" class="text-sm font-semibold text-[#A94EBD] hover:underline">Start</a>
            </div>

            <div class="glass rounded-2xl p-6 text-center hover:transform hover:-translate-y-2 transition-transform">
                <div
                    class="w-16 h-16 mx-auto bg-gradient-to-br from-[#A94EBD] to-[#4B2E5E] rounded-2xl flex items-center justify-center mb-4">
                    <i class="fas fa-calendar-alt text-white text-2xl"></i>
                </div>
                <h3 class="text-xl font-semibold text-[#4B2E5E] mb-2">Calendar</h3>
                <p class="text-sm text-[#4B2E5E] opacity-80 mb-4">Plan your days, weeks, and months with an easy-to-use
                    calendar.</p>
                <a href="calendar.html" class="text-sm font-semibold text-[#A94EBD] hover:underline">Start</a>
            </div>

            <div class="glass rounded-2xl p-6 text-center hover:transform hover:-translate-y-2 transition-transform">
                <div
                    class="w-16 h-16 mx-auto bg-gradient-to-br from-[#A94EBD] to-[#4B2E5E] rounded-2xl flex items-center justify-center mb-4">
                    <i class="fas fa-bell text-white text-2xl"></i>
                </div>
                <h3 class="text-xl font-semibold text-[#4B2E5E] mb-2">Reminders</h3>
                <p class="text-sm text-[#4B2E5E] opacity-80 mb-4">Never miss a task or event with timely reminders.</p>
                <a href="reminders.html" class="text-sm font-semibold text-[#A94EBD] hover:underline">Start</a>
            </div>

            <div class="glass rounded-2xl p-6 text-center hover:transform hover:-translate-y-2 transition-transform">
                <div
                    class="w-16 h-16 mx-auto bg-gradient-to-br from-[#A94EBD] to-[#4B2E5E] rounded-2xl flex items-center justify-center mb-4">
                    <i class="fas fa-check-square text-white text-2xl"></i>
                </div>
                <h3 class="text-xl font-semibold text-[#4B2E5E] mb-2">To-Do</h3>
                <p class="text-sm text-[#4B2E5E] opacity-80 mb-4">Manage your tasks efficiently with a smart to-do list.
                </p>
                <a href="Todo.html" class="text-sm font-semibold text-[#A94EBD] hover:underline">Start</a>
            </div>
        </div>
    </section>

    <!-- Stats Section -->
    <section class="glass mx-4 rounded-2xl py-12 px-6">
        <div class="max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
            <div>
                <div class="text-4xl font-bold text-[#A94EBD] mb-2">100+</div>
                <div class="text-sm text-[#4B2E5E] font-semibold">Users</div>
            </div>
            <div>
                <div class="text-4xl font-bold text-[#A94EBD] mb-2">10,000+</div>
                <div class="text-sm text-[#4B2E5E] font-semibold">Hours</div>
            </div>
            <div>
                <div class="text-4xl font-bold text-[#A94EBD] mb-2">200+</div>
                <div class="text-sm text-[#4B2E5E] font-semibold">Countries</div>
            </div>
        </div>
    </section>

    <!-- Help Section -->
    <section id="help" class="max-w-6xl mx-auto px-4 py-16">
        <div class="glass rounded-2xl p-8 md:p-12">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-[#4B2E5E] mb-2">Need Help?</h2>
                <p class="text-[#4B2E5E] opacity-80">How have we helped you or need support? We'd love to hear from you!</p>
            </div>

            <div class="max-w-md mx-auto">
                <!-- Updated form to handle submission and show thank you modal -->
                <form id="helpForm" class="space-y-6">
                    <div>
                        <label class="block text-sm font-semibold text-[#4B2E5E] mb-2">Name</label>
                        <input type="text" name="name" id="userName" required
                            class="w-full custom-input rounded-xl px-4 py-3 text-sm focus:outline-none transition-all">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-[#4B2E5E] mb-2">Email</label>
                        <input type="email" name="email" id="userEmail" required
                            class="w-full custom-input rounded-xl px-4 py-3 text-sm focus:outline-none transition-all">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-[#4B2E5E] mb-2">Message</label>
                        <textarea name="message" id="userMessage" required
                            class="w-full custom-input rounded-xl px-4 py-3 text-sm focus:outline-none transition-all h-32"
                            placeholder="Your message"></textarea>
                    </div>
                    <button type="submit" id="submitBtn" class="w-full btn-primary text-white font-semibold px-6 py-3 rounded-xl">
                        <i class="fas fa-paper-plane mr-2"></i>Send Message
                    </button>
                </form>
            </div>
        </div>
    </section>

    <!-- Reviews Section -->
    <section id="reviews" class="max-w-6xl mx-auto px-4 py-16">
        <div class="text-center mb-12">
            <h2 class="text-3xl font-bold text-[#4B2E5E] mb-2">Reviews</h2>
            <p class="text-[#4B2E5E] opacity-80 max-w-2xl mx-auto">Easily collect and share testimonials, amplify
                feedback, and speed up your success</p>
        </div>

        <div class="flex justify-center space-x-4 mb-8">
            <a href="review.html" class="btn-primary text-white font-semibold px-6 py-2 rounded-xl">
                Get a Review
            </a>
            <a href="review.html"
                class="border border-[#4B2E5E] text-[#4B2E5E] font-semibold px-6 py-2 rounded-xl hover:bg-[#f0e4ff] transition-colors">
                Explore
            </a>
        </div>

        <!-- Enhanced reviews grid with scroll functionality -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <div class="lg:col-span-2">
                <div id="reviewsGrid" class="reviews-scroll space-y-4">
                    <!-- Dynamic reviews will be loaded here -->
                </div>
            </div>
            <div class="lg:col-span-1">
                <div class="glass rounded-2xl p-6 sticky top-24">
                    <h3 class="text-lg font-bold text-[#4B2E5E] mb-4">What Our Users Say</h3>
                    <div class="space-y-4">
                        <div class="flex items-center space-x-2">
                            <div class="text-[#A94EBD]">â˜…â˜…â˜…â˜…â˜…</div>
                            <span class="text-sm text-[#4B2E5E]">4.8/5 Rating</span>
                        </div>
                        <div class="text-sm text-[#4B2E5E] opacity-80">
                            Join thousands of satisfied users who have transformed their productivity with Life.
                        </div>
                        <a href="review.html" class="block w-full text-center btn-primary text-white font-semibold px-4 py-2 rounded-xl text-sm">
                            Share Your Experience
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div id="reviewsLoading" class="text-center py-8">
            <i class="fas fa-spinner fa-spin text-2xl text-[#A94EBD]"></i>
            <p class="text-[#4B2E5E] mt-2">Loading reviews...</p>
        </div>
    </section>

    <!-- Footer -->
    <footer class="glass mx-4 mt-16 py-8 px-6 rounded-2xl">
        <div class="max-w-6xl mx-auto">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <div class="flex items-center space-x-3 mb-4">
                        <img src="imeges/Life Logo.png" alt="Life Logo" class="w-13 h-12">
                        <span class="font-bold text-[#4B2E5E] text-xl">Life</span>
                    </div>
                    <p class="text-xs text-[#4B2E5E] opacity-70">"Life is your all-in-one reminder app with calendars,
                        sticky notes, to-do lists, and moreâ€”stay organized effortlessly"</p>
                </div>

                <div>
                    <h4 class="text-sm font-semibold text-[#4B2E5E] mb-3">Quick Links</h4>
                    <ul class="space-y-2 text-xs text-[#4B2E5E] opacity-70">
                        <li><a class="hover:text-[#A94EBD] transition-colors" href="index.html">Home</a></li>
                        <li><a class="hover:text-[#A94EBD] transition-colors" href="#">Career Path</a></li>
                        <li><a class="hover:text-[#A94EBD] transition-colors" href="#">Courses</a></li>
                        <li><a class="hover:text-[#A94EBD] transition-colors" href="#">Help & Support</a></li>
                    </ul>
                </div>

                <div>
                    <h4 class="text-sm font-semibold text-[#4B2E5E] mb-3">About</h4>
                    <ul class="space-y-2 text-xs text-[#4B2E5E] opacity-70">
                        <li><a class="hover:text-[#A94EBD] transition-colors" href="#">How we work</a></li>
                        <li><a class="hover:text-[#A94EBD] transition-colors" href="#">Terms of service</a></li>
                    </ul>
                </div>

                <div>
                    <h4 class="text-sm font-semibold text-[#4B2E5E] mb-3">Contact Info</h4>
                    <address class="text-xs text-[#4B2E5E] opacity-70 not-italic mb-3">
                        No 108 2/1 Deniyawaththa Road , Katuwawala , Boralasgamuwa<br> Sri Lanka.
                    </address>
                    <p class="text-xs text-[#4B2E5E] opacity-70 mb-4">+94714320017</p>
                    <div class="flex space-x-4 text-[#4B2E5E]">
                        <a href="#" class="hover:text-[#A94EBD] transition-colors"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="hover:text-[#A94EBD] transition-colors"><i
                                class="fab fa-pinterest-p"></i></a>
                        <a href="#" class="hover:text-[#A94EBD] transition-colors"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
            </div>

            <div class="mt-8 pt-6 border-t border-[#4B2E5E] border-opacity-20 text-center">
                <p class="text-xs text-[#4B2E5E] opacity-70">Â© 2025 Life. All rights reserved. Website by Ravindu
                    Prakrama Sunimal</p>
                <div class="flex justify-center space-x-4 mt-2">
                    <a href="#" class="text-xs text-[#4B2E5E] opacity-70 hover:text-[#A94EBD] transition-colors">Terms
                        of Service</a>
                    <a href="#" class="text-xs text-[#4B2E5E] opacity-70 hover:text-[#A94EBD] transition-colors">Privacy
                        Policy</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- PWA Install Button - Always visible in bottom left -->
    <div id="pwaInstallButton" class="fixed bottom-6 left-6 z-50">
        <button id="installBtn" class="bg-gradient-to-r from-[#A94EBD] to-[#4B2E5E] text-white px-4 py-3 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 flex items-center glass border border-white/20 hover:scale-105 backdrop-blur-sm animate-float">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="mr-2">
                <path d="M12 2L12 15M12 15L8 11M12 15L16 11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M3 17L3 19C3 20.1046 3.89543 21 5 21L19 21C20.1046 21 21 20.1046 21 19L21 17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span class="text-sm font-semibold">Install App</span>
        </button>
    </div>

    <!-- PWA Status Messages -->
    <div id="pwaMessages" class="fixed bottom-20 left-6 z-40"></div>

    <!-- Thank You Modal -->
    <div id="thankYouModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="glass rounded-2xl p-8 max-w-md mx-4 text-center">
            <div class="mb-6">
                <!-- Replaced TGS animation with GIF -->
                <div id="gifAnimation" class="w-32 h-32 mx-auto mb-4">
                    <img src="/tgs/sending.gif" alt="Thank you animation" class="w-full h-full object-contain rounded-lg" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                    <div class="w-32 h-32 mx-auto flex items-center justify-center" style="display: none;">
                        <div class="relative">
                            <div class="w-20 h-20 bg-gradient-to-r from-[#A94EBD] to-[#4B2E5E] rounded-full flex items-center justify-center animate-pulse">
                                <i class="fas fa-check text-white text-3xl"></i>
                            </div>
                            <div class="absolute -top-2 -right-2 w-6 h-6 bg-green-500 rounded-full flex items-center justify-center animate-bounce">
                                <i class="fas fa-heart text-white text-xs"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <h3 class="text-2xl font-bold text-[#4B2E5E] mb-4">Thank You!</h3>
            <p class="text-[#4B2E5E] opacity-80 mb-6">Your message has been sent successfully. We'll get back to you soon!</p>
            <button onclick="closeThankYouModal()" class="btn-primary text-white font-semibold px-6 py-3 rounded-xl">
                <i class="fas fa-check mr-2"></i>Got it!
            </button>
        </div>
    </div>

    <script>
        let deferredPrompt;
        let isInstalled = false;
        const installButton = document.getElementById('installBtn');
        const pwaInstallContainer = document.getElementById('pwaInstallButton');
        const pwaMessages = document.getElementById('pwaMessages');
        let tgsPlayer = null;

        // Check if app is already installed
        function checkIfInstalled() {
            // Check if running in standalone mode (installed PWA)
            if (window.matchMedia('(display-mode: standalone)').matches || 
                window.navigator.standalone === true) {
                isInstalled = true;
                hideInstallButton();
                return true;
            }
            
            // Check if installed via other means
            if (document.referrer.includes('android-app://')) {
                isInstalled = true;
                hideInstallButton();
                return true;
            }
            
            return false;
        }

        // Show install button
        function showInstallButton() {
            if (!isInstalled && pwaInstallContainer) {
                pwaInstallContainer.style.display = 'block';
                pwaInstallContainer.style.opacity = '1';
                console.log('[PWA] Install button shown');
            }
        }

        // Hide install button
        function hideInstallButton() {
            if (pwaInstallContainer) {
                pwaInstallContainer.style.opacity = '0';
                setTimeout(() => {
                    pwaInstallContainer.style.display = 'none';
                }, 300);
                console.log('[PWA] Install button hidden');
            }
        }

        // Show PWA message
        function showPWAMessage(message, type = 'info', duration = 3000) {
            const messageDiv = document.createElement('div');
            const bgColor = type === 'success' ? 'bg-green-500' : 
                           type === 'error' ? 'bg-red-500' : 'bg-blue-500';
            
            messageDiv.className = `${bgColor} text-white px-4 py-3 rounded-2xl shadow-lg flex items-center glass border border-white/20 mb-2 transition-all duration-300`;
            messageDiv.innerHTML = `
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="mr-2">
                    ${type === 'success' ? 
                        '<path d="M9 12L11 14L15 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>' :
                        '<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/><path d="M12 6V12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><path d="M12 16H12.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>'
                    }
                </svg>
                <span class="text-sm font-semibold">${message}</span>
            `;
            
            pwaMessages.appendChild(messageDiv);
            
            // Auto remove after duration
            setTimeout(() => {
                messageDiv.style.opacity = '0';
                messageDiv.style.transform = 'translateX(-100%)';
                setTimeout(() => {
                    if (messageDiv.parentNode) {
                        messageDiv.parentNode.removeChild(messageDiv);
                    }
                }, 300);
            }, duration);
        }

        // Install app function
        async function installApp() {
            console.log('[PWA] Install button clicked');
            
            if (deferredPrompt) {
                try {
                    // Show the install prompt
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    
                    console.log('[PWA] User choice:', outcome);
                    
                    if (outcome === 'accepted') {
                        showPWAMessage('App installed successfully!', 'success');
                        isInstalled = true;
                        hideInstallButton();
                    } else {
                        showPWAMessage('Installation cancelled', 'info');
                    }
                    
                    deferredPrompt = null;
                } catch (error) {
                    console.error('[PWA] Install error:', error);
                    showPWAMessage('Installation failed. Please try again.', 'error');
                }
            } else {
                // Fallback for browsers that don't support install prompt
                if (navigator.userAgent.includes('iPhone') || navigator.userAgent.includes('iPad')) {
                    showPWAMessage('Tap Share button and "Add to Home Screen"', 'info', 5000);
                } else if (navigator.userAgent.includes('Android')) {
                    showPWAMessage('Tap menu and "Add to Home Screen"', 'info', 5000);
                } else {
                    showPWAMessage('Use browser menu to install this app', 'info', 5000);
                }
            }
        }

        // Listen for beforeinstallprompt event
        window.addEventListener('beforeinstallprompt', (e) => {
            console.log('[PWA] Install prompt available');
            e.preventDefault();
            deferredPrompt = e;
            
            if (!isInstalled) {
                showInstallButton();
                showPWAMessage('App can be installed!', 'info');
            }
        });

        // Listen for app installed event
        window.addEventListener('appinstalled', (evt) => {
            console.log('[PWA] App was installed');
            isInstalled = true;
            hideInstallButton();
            showPWAMessage('Welcome! App installed successfully!', 'success');
            deferredPrompt = null;
        });

        // Add click event to install button
        if (installButton) {
            installButton.addEventListener('click', installApp);
        }

        // Initialize PWA functionality
        function initializePWA() {
            console.log('[PWA] Initializing...');
            
            // Check if already installed
            if (checkIfInstalled()) {
                console.log('[PWA] App is already installed');
                return;
            }
            
            // Show install button by default
            showInstallButton();
            
            // Show welcome message
            setTimeout(() => {
                if (!isInstalled) {
                    showPWAMessage('Install this app for better experience!', 'info');
                }
            }, 2000);
            
            // Auto-hide install button after 30 seconds if not interacted
            setTimeout(() => {
                if (!isInstalled && pwaInstallContainer && pwaInstallContainer.style.display !== 'none') {
                    pwaInstallContainer.style.opacity = '0.7';
                    pwaInstallContainer.style.transform = 'scale(0.9)';
                }
            }, 30000);
        }

        // Register Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('[PWA] Service Worker registered successfully:', registration.scope);
                        
                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    showPWAMessage('New version available! Refresh to update.', 'info', 5000);
                                }
                            });
                        });
                        
                        // Initialize PWA after service worker is ready
                        initializePWA();
                    })
                    .catch(error => {
                        console.log('[PWA] Service Worker registration failed:', error);
                        showPWAMessage('Offline features unavailable', 'error');
                        // Still show install button even if SW fails
                        initializePWA();
                    });
            });
        } else {
            console.log('[PWA] Service Worker not supported');
            // Still show install button for browsers without SW support
            initializePWA();
        }

        // Mobile menu toggle
        document.getElementById('mobileMenuButton').addEventListener('click', function () {
            const menu = document.getElementById('mobileMenu');
            const icon = this.querySelector('i');

            menu.classList.toggle('open');

            if (menu.classList.contains('open')) {
                icon.classList.remove('fa-bars');
                icon.classList.add('fa-times');
            } else {
                icon.classList.remove('fa-times');
                icon.classList.add('fa-bars');
            }
        });

        // Close mobile menu when clicking on a link
        document.querySelectorAll('#mobileMenu a').forEach(link => {
            link.addEventListener('click', function () {
                const menu = document.getElementById('mobileMenu');
                const icon = document.getElementById('mobileMenuButton').querySelector('i');

                menu.classList.remove('open');
                icon.classList.remove('fa-times');
                icon.classList.add('fa-bars');
            });
        });

        // Firebase auth state observer
        auth.onAuthStateChanged(user => {
            const authSection = document.getElementById('authSection');

            if (user) {
                // User is signed in
                const displayName = user.displayName || user.email.split('@')[0];
                const firstLetter = displayName.charAt(0).toUpperCase();

                authSection.innerHTML = `
                    <div class="user-dropdown">
                        <div class="flex items-center space-x-2">
                            <div class="user-avatar" onclick="toggleDropdown()">${firstLetter}</div>
                        </div>
                        <div id="dropdownMenu" class="dropdown-content">
                            <a href="features.html"><i class="fas fa-rocket mr-2"></i>Features</a>
                            <a href="#" onclick="signOut()"><i class="fas fa-sign-out-alt mr-2"></i>Logout</a>
                        </div>
                    </div>
                `;
            } else {
                // User is signed out
                authSection.innerHTML = `
                    <a href="login.html" class="text-sm font-semibold text-[#4B2E5E] hover:text-[#A94EBD] transition-colors">LOGIN</a>
                `;
            }

            loadHomeReviews();
        });

        // Toggle dropdown menu
        function toggleDropdown() {
            document.getElementById('dropdownMenu').classList.toggle('show');
        }

        // Close dropdown when clicking outside
        window.onclick = function (event) {
            if (!event.target.matches('.user-avatar')) {
                const dropdowns = document.getElementsByClassName("dropdown-content");
                for (let i = 0; i < dropdowns.length; i++) {
                    const openDropdown = dropdowns[i];
                    if (openDropdown.classList.contains('show')) {
                        openDropdown.classList.remove('show');
                    }
                }
            }
        }

        // Sign out function
        function signOut() {
            auth.signOut().then(() => {
                // Sign-out successful
                window.location.href = 'index.html';
            }).catch((error) => {
                console.error('Sign out error:', error);
            });
        }

        async function loadHomeReviews() {
            const reviewsGrid = document.getElementById('reviewsGrid');
            const reviewsLoading = document.getElementById('reviewsLoading');

            try {
                const snapshot = await db.collection('reviews')
                    .orderBy('timestamp', 'desc')
                    .limit(6)
                    .get();

                reviewsGrid.innerHTML = '';

                if (snapshot.empty) {
                    // Show default reviews if no user reviews exist
                    const defaultReviews = [
                        { name: "Sanath Pathirana", role: "Product Manager", review: "Exceptional service and user-friendly design! Highly recommended.", rating: 5 },
                        { name: "Kawdhitha Nirmal", role: "Software Developer", review: "Impressive functionality and excellent customer support!", rating: 4 },
                        { name: "Nirmal Gamage", role: "Data Analyst", review: "Great app for staying organized. Would love more customization options.", rating: 4 },
                        { name: "Priya Silva", role: "Marketing Manager", review: "Life has completely transformed how I manage my daily tasks. Amazing!", rating: 5 },
                        { name: "Ravindu Perera", role: "UI/UX Designer", review: "Beautiful interface and intuitive design. Love using this app daily.", rating: 5 },
                        { name: "Chamika Fernando", role: "Business Analyst", review: "Reliable and efficient. Perfect for busy professionals like me.", rating: 4 }
                    ];

                    defaultReviews.forEach(review => {
                        const stars = 'â˜…'.repeat(review.rating) + 'â˜†'.repeat(5 - review.rating);
                        const reviewElement = document.createElement('div');
                        reviewElement.className = 'glass rounded-2xl p-4 mb-4';
                        reviewElement.innerHTML = `
                            <p class="text-sm text-[#4B2E5E] mb-4">"${review.review}"</p>
                            <div class="flex items-center">
                                <div class="w-8 h-8 rounded-full bg-[#f0e4ff] flex items-center justify-center mr-3">
                                    <span class="text-[#A94EBD] font-bold text-sm">${review.name.charAt(0)}</span>
                                </div>
                                <div>
                                    <h4 class="text-sm font-semibold text-[#4B2E5E]">${review.name}</h4>
                                    <p class="text-xs text-[#4B2E5E] opacity-70">${review.role}</p>
                                </div>
                            </div>
                            <div class="mt-3 text-[#A94EBD] text-sm">${stars}</div>
                        `;
                        reviewsGrid.appendChild(reviewElement);
                    });
                } else {
                    snapshot.forEach(doc => {
                        const review = doc.data();
                        const stars = 'â˜…'.repeat(review.rating) + 'â˜†'.repeat(5 - review.rating);
                        
                        const reviewElement = document.createElement('div');
                        reviewElement.className = 'glass rounded-2xl p-4 mb-4';
                        reviewElement.innerHTML = `
                            <p class="text-sm text-[#4B2E5E] mb-4">"${review.review}"</p>
                            <div class="flex items-center">
                                <div class="w-8 h-8 rounded-full bg-[#f0e4ff] flex items-center justify-center mr-3">
                                    <span class="text-[#A94EBD] font-bold text-sm">${review.userName.charAt(0).toUpperCase()}</span>
                                </div>
                                <div>
                                    <h4 class="text-sm font-semibold text-[#4B2E5E]">${review.userName}</h4>
                                    <p class="text-xs text-[#4B2E5E] opacity-70">Life User</p>
                                </div>
                            </div>
                            <div class="mt-3 text-[#A94EBD] text-sm">${stars}</div>
                        `;
                        reviewsGrid.appendChild(reviewElement);
                    });
                }

                startAutoScroll();
            } catch (error) {
                console.error('Error loading reviews:', error);
                // Show fallback content on error
                reviewsGrid.innerHTML = `
                    <div class="glass rounded-2xl p-4 text-center">
                        <i class="fas fa-comments text-2xl text-[#A94EBD] mb-2"></i>
                        <p class="text-[#4B2E5E] text-sm">Reviews will appear here once loaded</p>
                    </div>
                `;
            } finally {
                reviewsLoading.classList.add('hidden');
            }
        }

        function startAutoScroll() {
            const reviewsContainer = document.getElementById('reviewsGrid');
            if (!reviewsContainer) return;

            let scrollDirection = 1; // 1 for down, -1 for up
            let isPaused = false;
            let currentPosition = 0;

            function autoScroll() {
                if (isPaused) return;

                const scrollHeight = reviewsContainer.scrollHeight;
                const clientHeight = reviewsContainer.clientHeight;
                
                // Smooth continuous scrolling
                currentPosition += scrollDirection * 0.5;
                
                // Check boundaries and reverse direction
                if (currentPosition >= scrollHeight - clientHeight) {
                    scrollDirection = -1;
                    currentPosition = scrollHeight - clientHeight;
                } else if (currentPosition <= 0) {
                    scrollDirection = 1;
                    currentPosition = 0;
                }

                reviewsContainer.scrollTop = currentPosition;
            }

            const scrollInterval = setInterval(autoScroll, 30);

            // Pause auto-scroll on hover
            reviewsContainer.addEventListener('mouseenter', () => {
                isPaused = true;
            });

            // Resume auto-scroll when mouse leaves
            reviewsContainer.addEventListener('mouseleave', () => {
                isPaused = false;
            });

            let userScrollTimeout;
            let lastScrollTop = reviewsContainer.scrollTop;
            
            reviewsContainer.addEventListener('scroll', (e) => {
                const currentScrollTop = reviewsContainer.scrollTop;
                
                // Check if this was a manual scroll (not from auto-scroll)
                if (Math.abs(currentScrollTop - lastScrollTop) > 2) {
                    isPaused = true;
                    currentPosition = currentScrollTop;
                    
                    clearTimeout(userScrollTimeout);
                    userScrollTimeout = setTimeout(() => {
                        isPaused = false;
                    }, 2000); // Resume after 2 seconds
                }
                
                lastScrollTop = currentScrollTop;
            });

            // Clean up interval when page unloads
            window.addEventListener('beforeunload', () => {
                clearInterval(scrollInterval);
            });
        }

        // Load TGS animation
        // function loadTGSAnimation() {
        //     const tgsContainer = document.getElementById('tgsAnimation');
            
        //     // Create a fallback animation if TGS fails to load
        //     const createFallbackAnimation = () => {
        //         tgsContainer.innerHTML = `
        //             <div class="w-32 h-32 mx-auto flex items-center justify-center">
        //                 <div class="relative">
        //                     <div class="w-20 h-20 bg-gradient-to-r from-[#A94EBD] to-[#4B2E5E] rounded-full flex items-center justify-center animate-pulse">
        //                         <i class="fas fa-check text-white text-3xl"></i>
        //                     </div>
        //                     <div class="absolute -top-2 -right-2 w-6 h-6 bg-green-500 rounded-full flex items-center justify-center animate-bounce">
        //                         <i class="fas fa-heart text-white text-xs"></i>
        //                     </div>
        //                 </div>
        //             </div>
        //         `;
        //     };

        //     // Try to load TGS animation
        //     try {
        //         // Check if the TGS file exists
        //         fetch('./tgs/sendtgs.tgs')
        //             .then(response => {
        //                 if (response.ok) {
        //                     // If TGS library is available, use it
        //                     if (typeof lottie !== 'undefined') {
        //                         tgsPlayer = lottie.loadAnimation({
        //                             container: tgsContainer,
        //                             renderer: 'svg',
        //                             loop: true,
        //                             autoplay: true,
        //                             path: './tgs/sendtgs.tgs'
        //                         });
        //                     } else {
        //                         // Load Lottie library dynamically
        //                         const script = document.createElement('script');
        //                         script.src = 'https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js';
        //                         script.onload = () => {
        //                             tgsPlayer = lottie.loadAnimation({
        //                                 container: tgsContainer,
        //                                 renderer: 'svg',
        //                                 loop: true,
        //                                 autoplay: true,
        //                                 path: './tgs/sendtgs.tgs'
        //                             });
        //                         };
        //                         script.onerror = createFallbackAnimation;
        //                         document.head.appendChild(script);
        //                     }
        //                 } else {
        //                     createFallbackAnimation();
        //                 }
        //             })
        //             .catch(() => {
        //                 createFallbackAnimation();
        //             });
        //     } catch (error) {
        //         console.log('TGS loading error:', error);
        //         createFallbackAnimation();
        //     }
        // }

        // Show thank you modal
        function showThankYouModal() {
            const modal = document.getElementById('thankYouModal');
            modal.classList.remove('hidden');
            
            // Add entrance animation
            setTimeout(() => {
                modal.querySelector('.glass').style.transform = 'scale(1)';
                modal.querySelector('.glass').style.opacity = '1';
            }, 100);
        }

        // Close thank you modal
        function closeThankYouModal() {
            const modal = document.getElementById('thankYouModal');
            
            // Add exit animation
            modal.querySelector('.glass').style.transform = 'scale(0.9)';
            modal.querySelector('.glass').style.opacity = '0';
            
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300);
        }

        // Handle form submission
        document.getElementById('helpForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<div class="loading-spinner mr-2"></div>Sending...';
            submitBtn.disabled = true;
            
            try {
                // Get form data
                const formData = new FormData();
                formData.append('name', document.getElementById('userName').value);
                formData.append('email', document.getElementById('userEmail').value);
                formData.append('message', document.getElementById('userMessage').value);
                formData.append('_subject', 'New message from Life App');
                formData.append('_captcha', 'false');
                
                // Submit to FormSubmit
                const response = await fetch('https://formsubmit.co/lifeassistant60@gmail.com', {
                    method: 'POST',
                    body: formData
                });
                
                if (response.ok) {
                    // Reset form
                    this.reset();
                    
                    // Show thank you modal
                    showThankYouModal();
                } else {
                    throw new Error('Form submission failed');
                }
                
            } catch (error) {
                console.error('Form submission error:', error);
                alert('Sorry, there was an error sending your message. Please try again.');
            } finally {
                // Reset button
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        });

        // Close modal when clicking outside
        document.getElementById('thankYouModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeThankYouModal();
            }
        });
    </script>
</body>

</html>
